{{define "content"}}
<section class="section">
    <div class="container">
        <h1 class="title is-2 has-text-primary">{{.Titulo}}</h1>

        <div>
            <div>
                <div class="content box has-background-dark">
                    <h3 class="has-text-info">Descripci√≥n</h3>
                    <p>{{.Descripcion}}</p>

                    <h3 class="has-text-success">
                        Pasos para Prevenir (Mitigaci√≥n)
                    </h3>
                    <ul>
                        {{range .Mitigacion}}
                        <li>{{.}}</li>
                        {{end}}
                    </ul>
                    <div class="buttons mt-5">
                        <a href="/" class="button is-light is-outlined"
                            >‚Üê Volver al √çndice</a
                        >
                    </div>
                    <a
                        href="{{.OwaspURL}}"
                        target="_blank"
                        class="button is-small is-link is-outlined"
                    >
                        üìö Ver en OWASP Oficial
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    function escanearCodigo() {
        const codigo = document.getElementById("userInput").value;
        const resDiv = document.getElementById("result");

        // Simulaci√≥n de llamada al backend de Go
        fetch("/scan", {
            method: "POST",
            body: new URLSearchParams({ codigo: codigo }),
        })
            .then((res) => res.json())
            .then((data) => {
                resDiv.className = `notification mt-4 ${data.status === "peligroso" ? "is-danger" : "is-success"}`;
                resDiv.innerText = data.msg;
                resDiv.classList.remove("is-hidden");
            });
    }

    function ejecutarSandbox() {
        const codigo = document.getElementById("userInput").value;
        // Sandbox visual: solo muestra qu√© pasar√≠a sin ejecutarlo realmente en el cliente principal
        alert(
            "SISTEMA AISLADO: El c√≥digo ingresado intent√≥ acceder a: " +
                (codigo.includes("cookie")
                    ? "Tus Cookies de Sesi√≥n"
                    : "Recursos del sistema"),
        );
    }
</script>
{{end}}
